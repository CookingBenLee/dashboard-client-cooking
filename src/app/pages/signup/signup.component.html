<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Créer un Compte</title>
</head>

<body>
  <!-- <p-toast /> -->
  <div class="login-container">
    <!-- <div class="login-image-section" style="background-image: url('assets/images/logimage.jpg');"> -->
      <div class="login-image-section" style="background-image: url('assets/images/cook.jpeg');">
      
      <!-- Image de fond ou autre contenu -->
    </div>

    <div class="login-form-section">
      <div class="form-container">
        <!-- <h3>{{ error }}</h3> -->
        <h2>Créer un Compte</h2>
        <!-- <p>Veuillez entrer vos informations personnelles pour continuer</p> -->

        <form id="login" #fCreate="ngForm" (ngSubmit)="addUserAccount(fCreate)">
          <fieldset>
            <legend>Informations Personnelles</legend>

            <div class="form-group">
              <label for="user-role">Type de compte :</label> 
              <div class="input-container">
                <select name="user-role" id="user-role" [(ngModel)]="compteUser.typeCompte" required
                  #typeCompteInput="ngModel"
                  [ngClass]="{'ng-invalid': typeCompteInput.invalid && typeCompteInput.touched}">
                  <option   disabled selected>Choisissez le type de compte</option>

                  <!-- Liez l'objet de compte complet, pas seulement l'ID -->
                  <option *ngFor="let account of typeAccounts" [ngValue]="account">
                    {{ account.libelle }}
                  </option>
                </select>
                <div *ngIf="typeCompteInput.invalid && typeCompteInput.touched" class="error-message">
                  Le type de compte est requis.
                </div>
              </div>
              <div class="form-group">
                <label for="denomination">Dénomination :</label> 
                <div class="input-container">
                  <input type="text" name="denomination" id="denomination" required [(ngModel)]="compteUser.denomination"
                    noWhitespace #denominationInput="ngModel" [ngClass]="{'ng-invalid': denominationInput.invalid && denominationInput.touched}" />
                  <div *ngIf="denominationInput.invalid && denominationInput.touched" class="error-message">
                    Le nom du compte est requis.
                  </div>
                </div>
              </div>
            </div>

            <div class="information">
              
              <div class="form-group" style="flex: 1;">
                <label for="nom">Nom :</label> 
                <div class="input-container">
                  <input type="text" name="nom" id="nom" required [(ngModel)]="compteUser.nom"
                    noWhitespace #nomInput="ngModel" [ngClass]="{'ng-invalid': nomInput.invalid && nomInput.touched}" />
                  <div *ngIf="nomInput.invalid && nomInput.touched" class="error-message">
                    Le nom est requis.
                  </div>
                </div>
              </div>

              <div class="form-group" style="flex: 1;">
                <label for="prenom">Prénom :</label>
                <div class="input-container">
                  <input type="text" name="prenom" id="prenom"  required
                    [(ngModel)]="compteUser.prenom" noWhitespace #prenomInput="ngModel"
                    [ngClass]="{'ng-invalid': prenomInput.invalid && prenomInput.touched}" />
                  <div *ngIf="prenomInput.invalid && prenomInput.touched" class="error-message">
                    Le prénom est requis.
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="email">Email :</label> 
              <div class="input-container">
                <input type="text" name="login" id="login" required [(ngModel)]="compteUser.login"
                  noWhitespace #emailInput="ngModel"
                  [ngClass]="{'ng-invalid': emailInput.invalid && emailInput.touched}" />
                <div *ngIf="emailInput.invalid && emailInput.touched" class="error-message">
                  Un email valide est requise.
                </div>
              </div>
            </div>

            <div class="information">
              <div class="form-group" style="flex: 1;">
                <label for="password">Mot de passe :</label> 
                <div class="input-container password-container">
                  <input type="password" name="password" id="password" required
                    [(ngModel)]="compteUser.password" noWhitespace #passwordInput="ngModel"
                    [ngClass]="{'ng-invalid': passwordInput.invalid && passwordInput.touched}" />
                  <div *ngIf="passwordInput.invalid && passwordInput.touched" class="error-message">
                    Le mot de passe est requis.
                  </div>
                  <small style="color: red; margin-top: 5px;">{{ errorMessage }}</small>
                </div>
              </div>
              <div class="form-group" style="flex: 1;">
                <label for="password">Confirmation de mot de passe :</label> 
                <div class="input-container password-container">
                  <input type="password" name="confirmation" id="confirmation"  required
                    [(ngModel)]="compteUser.confirmation" noWhitespace #confirmationInput="ngModel"
                    [ngClass]="{'ng-invalid': confirmationInput.invalid && confirmationInput.touched}" />
                  <div *ngIf="confirmationInput.invalid && confirmationInput.touched" class="error-message">
                    La confirmation de mot de passe est requis.
                  </div>
                  <small style="color: red; margin-top: 20px;margin-bottom: 20px;">{{ errorMessage }}</small>
                </div>
              </div>
            </div>


            <fieldset class="nested">
              <legend>Adresses Personnelles</legend>
              <div class="information">

                <div class="form-group" style="flex: 2;">
                  <label for="streetName">Rue :</label>
                  <div class="input-container">
                    <input type="text" name="streetName" id="streetName" required
                      [(ngModel)]="adresseS.streetName" noWhitespace #streetNameInput="ngModel"
                      [ngClass]="{'ng-invalid': streetNameInput.invalid && streetNameInput.touched}" />
                    <div *ngIf="streetNameInput.invalid && streetNameInput.touched" class="error-message">
                      Le nom de la rue est requis.
                    </div>
                  </div>
                </div>

                <div class="form-group" style="flex: 1;">
                  <label for="streetNumber">Numéro de la rue :</label>
                  <div class="input-container">
                    <input type="number" name="streetNumber" id="streetNumber" required
                      [(ngModel)]="adresseS.streetNumber" noWhitespace #streetNumberInput="ngModel"
                      [ngClass]="{'ng-invalid': streetNumberInput.invalid && streetNumberInput.touched}" />
                    <div *ngIf="streetNumberInput.invalid && streetNumberInput.touched" class="error-message">
                      Le numéro de rue est requis.
                    </div>
                  </div>
                </div>


              </div>
              <!-- Ligne 2 -->
              <div class="information">
                <div class="form-group" style="flex: 1;">
                  <label for="label">Code postal :</label>
                  <div class="input-container">
                    <input type="text" name="label" id="label"  required
                      [(ngModel)]="adresseS.label" noWhitespace #labelInput="ngModel"
                      [ngClass]="{'ng-invalid': labelInput.invalid && labelInput.touched}" />
                    <div *ngIf="labelInput.invalid && labelInput.touched" class="error-message">
                      Le code postal est requis.
                    </div>
                  </div>
                </div>
                <div class="form-group" style="flex: 2;">
                  <label for="city">Ville :</label>
                  <div class="input-container">
                    <input type="text" name="city" id="city" required [(ngModel)]="adresseS.city"
                      noWhitespace #cityInput="ngModel"
                      [ngClass]="{'ng-invalid': cityInput.invalid && cityInput.touched}" />
                    <div *ngIf="cityInput.invalid && cityInput.touched" class="error-message">
                      La ville est requise..
                    </div>
                  </div>
                </div>


              </div>

              <div class="form-group" style="flex: 1;">

                <label for="country">Pays :</label>
                <div class="input-container">
                  <select name="country" id="country" [(ngModel)]="adresseS.country" required #countryInput="ngModel"
                    [ngClass]="{'ng-invalid': countryInput.invalid && countryInput.touched}">
                    <option value="" disabled selected>Choisissez le pays</option>

                    <!-- Liez l'objet de compte complet, pas seulement l'ID -->
                    <option *ngFor="let pay of pays" [ngValue]="pay">
                      {{ pay.name }}
                    </option>
                  </select>
                  <div *ngIf="countryInput.invalid && countryInput.touched" class="error-message">
                    Le pays est requis.
                  </div>
                </div>
              </div>
            </fieldset>
          

            <fieldset>
              <legend>LOGO DU COMPTE</legend>
              
              <div class="form-group" style="text-align: center;">
                <label for="fileInput" class="file-label">Sélectionnez votre logo :</label>
                <input type="file" id="fileInput" (change)="onFileSelected($event)" accept="image/*" hidden>
                
                <!-- Bouton stylisé pour ouvrir le sélecteur -->
                <button type="button" class="btn-upload" (click)="clickFileSelector()">Choisir une image</button>
                        <!-- Aperçu de l'image -->
                <div class="preview-container" *ngIf="previewUrl">
                  <p>Aperçu :</p>
                  <img [src]="previewUrl" alt="Aperçu du logo" class="preview-image" style="{width:512px;Heigth:512px;}">
                </div>
              </div>
            </fieldset>
            


          </fieldset>


          
          <!-- Bouton de Soumission -->
          <div class="form-group">
            <button type="submit" [disabled]="!fCreate.valid" class="btn-login">Créer un compte</button>
          </div>
        </form>

        <div class="err_msg mt-3">
          <p class="text-danger">
            <small id="username-help">Vous avez déjà un compte ? <a href="#" [routerLink]="['/login']"
                style="color: red;" class="forgot-password"> Connexion </a></small>
          </p>
        </div>
      </div>
    </div>
  </div>





  <p-dialog header="Enregistrement d'adresse" [modal]="true" [(visible)]="visibleAdd" [style]="{ width: '50rem' }"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }">
    <div class="col-12">
      <div class="top">
        <form #fCreate="ngForm" (ngSubmit)="save()">


          <div style="margin-top: 20px;" class="form-group">
            <button type="submit" class="btn-login">Enregistrer votre Adresse</button>
          </div>
        </form>
      </div>
    </div>
  </p-dialog>


  <p-toast position="top-center" key="tc"></p-toast>
  <p-toast></p-toast>
</body>

</html>